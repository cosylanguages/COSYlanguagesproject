"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[640],{349:(e,r,t)=>{t.d(r,{Yj:()=>n,x$:()=>o});const o=(e,r)=>new Promise((t,o)=>{if("undefined"===typeof window||!window.speechSynthesis)return console.error("SpeechUtils: Speech Synthesis not supported by this browser."),void o(new Error("Speech Synthesis not supported"));if(!e||""===String(e).trim())return console.warn("PronounceText: No text provided."),void t();const n=function(e){let r,t=!1;const o=String(e||"");switch(o){case"COSYenglish":r="en-US";break;case"COSYfran\xe7ais":r="fr-FR";break;case"COSYespa\xf1ol":r="es-ES";break;case"COSYitaliano":r="it-IT";break;case"COSYdeutsch":r="de-DE";break;case"COSYportugu\xeas":r="pt-PT";break;case"\u039a\u039f\u0396\u03a5\u03b5\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac":r="el-GR";break;case"\u0422\u0410\u041a\u041e\u0419\u0440\u0443\u0441\u0441\u043a\u0438\u0439":r="ru-RU";break;case"\u053e\u0548\u054d\u0545\u0570\u0561\u0575\u056f\u0561\u056f\u0561\u0576":r="hy-AM";break;case"COSYbrezhoneg":r="fr-FR",t=!0;break;case"COSYtatar\xe7a":case"COSYbashkort":r="ru-RU",t=!0;break;default:console.warn(`SpeechUtils: Unknown COSYlanguage "${o}". Defaulting to en-US.`),r="en-US",t=!0}return t&&""!==o&&console.warn(`SpeechUtils: No direct speech synthesis voice for ${e}. Using fallback ${r}.`),r}(r),s=new SpeechSynthesisUtterance(String(e).trim());s.lang=n,window.speechSynthesis.cancel(),s.onstart=()=>{console.log(`SpeechUtils: Speaking "${e}" in ${r} (mapped to ${n})`),t()},s.onerror=r=>{console.error("SpeechUtils: SpeechSynthesisUtterance.onerror - Error speaking:",r.error,"for text:",e,"lang:",n),o(r.error instanceof Error?r.error:new Error(String(r.error||"Unknown speech error")))},window.speechSynthesis.speak(s)}),n=()=>{if("undefined"!==typeof window&&"undefined"!==typeof Audio)try{const e=new Audio("data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA");e.volume=0;const r=e.play();void 0!==r&&r.then(e=>{console.log("SpeechUtils: Audio playback likely unlocked.")}).catch(e=>{console.warn("SpeechUtils: Audio unlock failed (this is common, user interaction might be needed for audio):",e)})}catch(e){console.error("SpeechUtils: Error trying to unlock audio:",e)}};console.log("[SpeechUtils] Service loaded with TTS and language mapping.")},640:(e,r,t)=>{t.r(r),t.d(r,{default:()=>m});var o=t(5043),n=t(7129),s=t(6951),a=t(5444),i=t(6568),l=t(349),c=t(6835),d=t(579);const u=e=>{let{onCheckAnswer:r,onRevealAnswer:t,onShowHint:o,onRandomize:s,onNextExercise:a,config:i={},isAnswerCorrect:l=!1,isRevealed:u=!1,customButton:h=null}=e;const{t:p}=(0,n.s)(),{showCheck:g=!!r,checkButtonText:x=p("buttons.check","\u2714\ufe0f Check"),showReveal:f=!!t,revealButtonText:m=p("buttons.revealAnswer","\ud83e\udd2b Reveal Answer"),showHint:y=!!o,hintButtonText:w=p("buttons.help","\ud83d\udca1 Hint"),showRandomize:b=!!s,randomizeButtonText:v=p("buttons.randomize","\ud83c\udfb2 Randomize"),showNext:S=!!a,nextButtonText:C=p("buttons.next","\u27a1\ufe0f Next Exercise")}=i,k=!l&&!u;return(0,d.jsxs)("div",{className:"exercise-action-buttons",children:[y&&o&&(0,d.jsx)(c.A,{onClick:o,disabled:!k,className:"btn-warning",children:w}),b&&s&&(0,d.jsx)(c.A,{onClick:s,disabled:!k&&!S,className:"btn-secondary",children:v}),g&&r&&(0,d.jsx)(c.A,{onClick:r,disabled:!k,className:"btn-success",children:x}),f&&t&&(0,d.jsx)(c.A,{onClick:t,disabled:!k,className:"btn-info",children:m}),h,S&&a&&(0,d.jsx)(c.A,{onClick:a,className:"btn-primary",children:C})]})},h=e=>{let{message:r,type:t,language:o}=e;const n=(0,i.A)("string"===typeof r?r:"",o),s="string"===typeof r&&o?n:r,{isLatinized:l}=(0,a.te)();if(!r)return(0,d.jsx)("div",{style:{minHeight:"24px",margin:"10px 0"},"aria-live":"polite"});let c={padding:"15px",margin:"10px 0",borderRadius:"8px",textAlign:"center",minHeight:"24px",fontWeight:"bold",animation:"fadeIn 0.5s ease-in-out"};"correct"===t&&(c.animation="correct-answer-animation 0.5s ease-in-out");let u="";switch(t){case"correct":c.backgroundColor="var(--color-success-bg)",c.color="var(--color-success-text)",c.borderColor="var(--color-success-border)",u="\ud83c\udf89 ";break;case"incorrect":c.backgroundColor="var(--color-danger-bg)",c.color="var(--color-danger-text)",c.borderColor="var(--color-danger-border)",u="\ud83e\udd14 ";break;case"hint":c.backgroundColor="var(--color-warning-bg)",c.color="var(--color-warning-text)",c.borderColor="var(--color-warning-border)",u="\ud83d\udca1 ";break;case"info":c.backgroundColor="var(--color-info-bg)",c.color="var(--color-info-text)",c.borderColor="var(--color-info-border)",u="\u2139\ufe0f ";break;case"error":c.backgroundColor="var(--color-danger-bg)",c.color="var(--color-danger-text)",c.borderColor="var(--color-danger-border)",u="\u26a0\ufe0f ";break;default:c.backgroundColor="var(--color-surface-medium)",c.color="var(--color-text-primary)",c.borderColor="var(--color-border)"}return l&&"string"===typeof s&&"string"===typeof r&&s!==r&&(c.fontStyle="italic"),(0,d.jsxs)("div",{style:c,role:"alert","aria-live":"assertive",children:[u,s]})};var p=t(1712);function g(e){const r=[...e];for(let t=r.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[r[t],r[e]]=[r[e],r[t]]}return r}function x(e){if(null===e||void 0===e)return"";let r=String(e).normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase();return r=r.replace(/[\u2019\u2018\u02bc]/g,"'"),r}const f=[{key:"show_word",Component:e=>{let{language:r,days:t,exerciseKey:c,onComplete:g}=e;const[x,f]=(0,o.useState)(""),[m,y]=(0,o.useState)(!0),[w,b]=(0,o.useState)(null),{isLatinized:v}=(0,a.te)(),{t:S,language:C}=(0,n.s)(),k=(0,i.A)(x,r);(0,o.useEffect)(()=>{(0,l.Yj)()},[]);const j=(0,o.useCallback)(async()=>{y(!0),b(null),f("");try{const{data:e,error:o}=await(0,s.Vu)(r,t);if(o)throw new Error(o.message||o.error||"Failed to load vocabulary words.");if(e&&e.length>0){const r=Math.floor(Math.random()*e.length);f(e[r])}else b(S("exercises.noVocabWords","No vocabulary words found for the selected criteria."))}catch(e){console.error("ShowWordExercise - Error fetching word:",e),b(e.message||S("errors.unexpectedError","An unexpected error occurred."))}finally{y(!1)}},[r,t,S]);(0,o.useEffect)(()=>{r&&t&&t.length>0?j():(y(!1),b(S("errors.selectLangDay","Please select a language and day(s).")),f(""))},[j,c,r,t,S]);const A=()=>{g?g():j()},N=v&&x!==k?{fontFamily:"Arial, sans-serif",fontStyle:"italic"}:{};return m?(0,d.jsx)("p",{children:(0,d.jsx)(p.A,{text:S("loading.wordExercise","Loading word..."),langOverride:C})}):w?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(h,{message:w,type:"error",language:C}),(0,d.jsx)(u,{onRandomize:A,onNextExercise:A,config:{showNext:!0,showCheck:!1,showHint:!1,showReveal:!1,showRandomize:!0}})]}):x||m?(0,d.jsxs)("div",{style:{textAlign:"center",padding:"20px",border:"1px solid #eee",borderRadius:"8px"},children:[(0,d.jsx)("h3",{children:(0,d.jsx)(p.A,{text:S("titles.randomWord","Random Word"),langOverride:C})}),x&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{style:{fontSize:"2.5rem",margin:"20px 0",padding:"10px",...N},"aria-label":`Word to practice: ${x}`,children:k||x}),(0,d.jsxs)("div",{style:{marginTop:"20px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"15px"},children:[(0,d.jsxs)("button",{onClick:async()=>{if(x&&r)try{await(0,l.x$)(x,r)}catch(e){console.error("Error pronouncing word:",e),b(S("errors.pronunciationError","Could not pronounce the word. Please ensure your browser supports speech synthesis and audio is enabled."))}},className:"action-button",disabled:!x,children:["\ud83d\udd0a ",(0,d.jsx)(p.A,{text:S("buttons.pronounce","Pronounce"),langOverride:C})]}),(0,d.jsx)(u,{onRandomize:A,onNextExercise:A,config:{showNext:!0,showCheck:!1,showHint:!1,showReveal:!1,showRandomize:!0}})]})]})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(h,{message:S("exercises.noWordToDisplay","No word to display. Try different selections or check data."),type:"info",language:C}),(0,d.jsx)(u,{onRandomize:A,onNextExercise:A,config:{showNext:!0,showCheck:!1,showHint:!1,showReveal:!1,showRandomize:!0}})]})},name:"Show Word"},{key:"type_opposite",Component:e=>{var r;let{language:t,days:c,exerciseKey:x,onComplete:f}=e;const[m,y]=(0,o.useState)(""),[w,b]=(0,o.useState)(""),[v,S]=(0,o.useState)([]),[C,k]=(0,o.useState)({message:"",type:""}),[j,A]=(0,o.useState)(!0),[N,T]=(0,o.useState)(null),[E,R]=(0,o.useState)(!1),{isLatinized:$}=(0,a.te)(),O=i.A,{t:W,language:I}=(0,n.s)(),z=(0,o.useCallback)(async()=>{A(!0),T(null),k({message:"",type:""}),y(""),b(""),S([]),R(!1);try{const{data:e,error:r}=await(0,s.pC)(t,c);if(r||!e||0===Object.keys(e).length)return T(W("exercises.noOppositesData","No opposites data found for the selected criteria.")),void A(!1);const o=Object.keys(e);if(0===o.length)return T(W("exercises.noWordsWithOpposites","No words with opposites found.")),void A(!1);const n=o[Math.floor(Math.random()*o.length)],a=e[n];y(n),b(a);const{data:i,error:l}=await(0,s.Vu)(t,c);let d=[];d=!l&&i?i.map(e=>"string"===typeof e?e:e.word).filter(Boolean):[...new Set([...o,...Object.values(e)])],d=d.filter(e=>e!==n&&e!==a),g(d);const u=d.slice(0,3),h=[{text:a,id:`opt_correct_${a}`,isCorrect:!0,status:"unselected"}];if(u.forEach((e,r)=>{h.push({text:e,id:`opt_distractor_${e}_${r}`,isCorrect:!1,status:"unselected"})}),h.length<2)return T(W("exercises.notEnoughOptionsForMCQ","Not enough distinct words to create multiple choice options.")),void A(!1);S(g(h))}catch(e){console.error("TypeOppositeExercise (MCQ) - Error setting up:",e),T(e.message||W("errors.unexpectedError","An unexpected error occurred."))}finally{A(!1)}},[t,c,W]);(0,o.useEffect)(()=>{t&&c&&c.length>0?z():(A(!1),T(W("errors.selectLangDay","Please select a language and day(s).")))},[z,x,t,c,W]);const B=()=>{f?f():z()};return j?(0,d.jsx)("p",{children:W("loading.oppositesExercise","Loading opposites exercise...")}):N?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(h,{message:N,type:"error"}),(0,d.jsx)(u,{onNextExercise:B,onRandomize:B,config:{showNext:!0,showRandomize:!0}})]}):0!==v.length||j?(0,d.jsxs)("div",{className:"type-opposite-exercise mcq-variant",children:[(0,d.jsxs)("h3",{children:[(0,d.jsx)(p.A,{text:W("titles.whatIsTheOppositeOf","What is the opposite of:"),langOverride:I}),(0,d.jsx)("strong",{style:{marginLeft:"8px",...$&&m!==O(m,t)&&{fontStyle:"italic"}},children:O(m,t)}),(0,d.jsx)("button",{onClick:()=>{m&&t&&(0,l.x$)(m,t).catch(e=>{console.error("Pronunciation error:",e),k({message:W("errors.pronunciationError","Could not pronounce the word."),type:"error"})})},disabled:!m,title:W("tooltips.pronounceWord","Pronounce word"),className:"pronounce-btn-inline",children:"\ud83d\udd0a"})]}),(0,d.jsx)("div",{className:"mcq-options-container",children:v.map(e=>(0,d.jsx)("button",{onClick:()=>{return r=e,void(E||j||(R(!0),r.isCorrect?(k({message:W("feedback.correct","Correct!"),type:"correct"}),S(e=>e.map(e=>e.id===r.id?{...e,status:"correct"}:e))):(k({message:W("feedback.incorrectAnswerWas",`Incorrect. The correct opposite of "${O(m,t)}" is "${O(w,t)}".`,{targetWord:O(m,t),correctAnswer:O(w,t)}),type:"incorrect"}),S(e=>e.map(e=>e.id===r.id?{...e,status:"incorrect"}:e.isCorrect?{...e,status:"correct"}:e))),f&&setTimeout(()=>f(),r.isCorrect?1500:2e3)));var r},className:`mcq-option-btn ${e.status}`,disabled:E||j,children:O(e.text,t)},e.id))}),(0,d.jsx)(h,{message:C.message,type:C.type}),(0,d.jsx)(u,{onNextExercise:B,onRandomize:B,isAnswerCorrect:E&&(null===(r=v.find(e=>"correct"===e.status))||void 0===r?void 0:r.isCorrect),config:{showCheck:!1,showHint:!1,showReveal:!1,showNext:!0,showRandomize:!0}})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(h,{message:W("exercises.noOppositesPair","No opposites pair available for MCQ. Try different selections."),type:"info"}),(0,d.jsx)(u,{onNextExercise:B,onRandomize:B,config:{showNext:!0,showRandomize:!0}})]})},name:"Type Opposite"},{key:"match_opposites",Component:e=>{let{language:r,days:t,exerciseKey:n}=e;const[l,c]=(0,o.useState)([]),[p,f]=(0,o.useState)([]),[m,y]=(0,o.useState)([]),[w,b]=(0,o.useState)(null),[v,S]=(0,o.useState)(null),[C,k]=(0,o.useState)({}),[j,A]=(0,o.useState)({message:"",type:""}),[N,T]=(0,o.useState)(!0),[E,R]=(0,o.useState)(null),[$,O]=(0,o.useState)(0),[W,I]=(0,o.useState)(!1),[z,B]=(0,o.useState)([]);(0,a.te)();const Y=i.A,L=(0,o.useRef)({}),F=(0,o.useRef)(null),M=(0,o.useCallback)(async()=>{T(!0),R(null),A({message:"",type:""}),b(null),S(null),k({}),O(0),I(!1),B([]),L.current={};try{const{data:e,error:o}=await(0,s.pC)(r,t);if(o)throw new Error(o.message||o.error||"Failed to load opposites data.");if(!e||Object.keys(e).length<2)return R(`Not enough opposites data (found ${Object.keys(e).length}) for this exercise. Need at least 2 base pairs.`),c([]),void T(!1);const n=Object.entries(e).map(e=>{let[r,t]=e;return{word:r,opposite:t}}),a=g(n).slice(0,4);if(a.length<1)return R("Could not select enough unique pairs for the exercise."),c([]),void T(!1);c(a),f(g(a.map(e=>e.word))),y(g(a.map(e=>e.opposite)))}catch(e){console.error("MatchOppositesExercise - Error setting up exercise:",e),R(e.message||"An unexpected error occurred."),c([])}finally{T(!1)}},[r,t]);(0,o.useEffect)(()=>{r&&t&&t.length>0?M():(T(!1),R("Please select a language and day(s)."))},[M,n,r,t]);const U=(e,r,t)=>{if(C[e]||W)return;const o={value:e,element:t.target};if("word"===r){if(w&&w.element===t.target)return void b(null);b(o)}else if("opposite"===r){if(v&&v.element===t.target)return void S(null);S(o)}},H=(0,o.useCallback)((e,r)=>{if(!e||!r||!F.current)return;const t=F.current.getBoundingClientRect(),o=e.getBoundingClientRect(),n=r.getBoundingClientRect(),s=o.left+o.width/2-t.left+F.current.scrollLeft,a=o.top+o.height/2-t.top+F.current.scrollTop,i=n.left+n.width/2-t.left+F.current.scrollLeft,l=n.top+n.height/2-t.top+F.current.scrollTop,c=`line-${x(e.textContent)}-${x(r.textContent)}`;B(e=>[...e,{x1:s,y1:a,x2:i,y2:l,key:c}])},[]);(0,o.useEffect)(()=>{if(w&&v){const e=w.value,r=v.value;l.some(t=>t.word===e&&t.opposite===r)?(A({message:"Correct Match!",type:"correct"}),k(t=>({...t,[e]:!0,[r]:!0})),w.element&&v.element&&H(w.element,v.element),O(e=>e+1),b(null),S(null)):(A({message:"Incorrect Match. Try again.",type:"incorrect"}),w.element&&w.element.classList.add("incorrect-flash"),v.element&&v.element.classList.add("incorrect-flash"),setTimeout(()=>{w&&w.element&&w.element.classList.remove("incorrect-flash"),v&&v.element&&v.element.classList.remove("incorrect-flash"),b(null),S(null)},1e3))}},[w,v,l,H]),(0,o.useEffect)(()=>{l.length>0&&$===l.length&&!W&&A({message:"All pairs matched! Well done!",type:"success"})},[$,l.length,W]);if(N)return(0,d.jsx)("p",{children:"Loading matching exercise..."});if(E)return(0,d.jsx)(h,{message:E,type:"error"});if(0===l.length&&!N)return(0,d.jsx)(h,{message:"No pairs available for this exercise.",type:"info"});const P={display:"flex",flexDirection:"column",gap:"8px",alignItems:"center",margin:"0 15px",flex:1},D=(e,r)=>{let t={padding:"12px 18px",border:"2px solid #ddd",borderRadius:"8px",cursor:"pointer",minWidth:"150px",textAlign:"center",backgroundColor:"#fff",transition:"background-color 0.2s, border-color 0.2s, transform 0.1s",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"};return C[e]?(t.backgroundColor="#e6ffed",t.borderColor="#b7eac9",t.cursor="default",t.fontWeight="bold"):("word"===r&&(null===w||void 0===w?void 0:w.value)===e||"opposite"===r&&(null===v||void 0===v?void 0:v.value)===e)&&(t.backgroundColor="#e0efff",t.borderColor="#90caf9",t.transform="scale(1.03)"),t};return(0,d.jsxs)("div",{style:{textAlign:"center",padding:"20px",border:"1px solid #eee",borderRadius:"8px",maxWidth:"600px",margin:"auto"},children:[(0,d.jsx)("h3",{children:"Match the Opposites"}),(0,d.jsxs)("div",{ref:F,style:{display:"flex",justifyContent:"center",margin:"20px 0",position:"relative"},children:[(0,d.jsx)("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:0},children:z.map(e=>(0,d.jsx)("line",{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stroke:"#28a745",strokeWidth:"3",opacity:"0.7"},e.key))}),(0,d.jsxs)("div",{style:{...P,zIndex:1},children:[" ",(0,d.jsx)("h4",{children:"Words"}),p.map(e=>(0,d.jsx)("button",{ref:r=>L.current[`word-${e}`]=r,style:D(e,"word"),onClick:r=>U(e,"word",r),disabled:C[e]||W,className:(null===w||void 0===w?void 0:w.value)!==e||C[e]?"":"selected-match-item",children:Y(e,r)},`word-${e}`))]}),(0,d.jsxs)("div",{style:{...P,zIndex:1},children:[(0,d.jsx)("h4",{children:"Opposites"}),m.map(e=>(0,d.jsx)("button",{ref:r=>L.current[`opposite-${e}`]=r,style:D(e,"opposite"),onClick:r=>U(e,"opposite",r),disabled:C[e]||W,className:(null===v||void 0===v?void 0:v.value)!==e||C[e]?"":"selected-match-item",children:Y(e,r)},`opp-${e}`))]})]}),(0,d.jsx)(h,{message:j.message,type:j.type,language:r}),(0,d.jsx)(u,{onShowHint:!W&&$<l.length?()=>{if(W||$===l.length)return;const e=l.filter(e=>!C[e.word]&&!C[e.opposite]);if(e.length>0){const t=e[0];A({message:`Hint: Try matching "${Y(t.word,r)}" or "${Y(t.opposite,r)}".`,type:"hint"})}else A({message:"No more hints available.",type:"info"})}:void 0,onRevealAnswer:!W&&$<l.length?()=>{I(!0);const e={},r=[];l.forEach(t=>{e[t.word]=!0,e[t.opposite]=!0;const o=L.current[`word-${t.word}`],n=L.current[`opposite-${t.opposite}`];if(o&&n&&F.current){const e=F.current.getBoundingClientRect(),s=o.getBoundingClientRect(),a=n.getBoundingClientRect(),i=s.left+s.width/2-e.left+F.current.scrollLeft,l=s.top+s.height/2-e.top+F.current.scrollTop,c=a.left+a.width/2-e.left+F.current.scrollLeft,d=a.top+a.height/2-e.top+F.current.scrollTop;r.push({x1:i,y1:l,x2:c,y2:d,key:`line-${x(t.word)}-${x(t.opposite)}`})}}),k(e),B(r),O(l.length),A({message:"All pairs revealed.",type:"info"})}:void 0,onNextExercise:M,config:{showCheck:!1,showHint:!W&&$<l.length&&l.length>0,showReveal:!W&&$<l.length&&l.length>0,showNext:!0}})]})},name:"Match Opposites"},{key:"build_word",Component:e=>{let{language:r,days:t,exerciseKey:c,onComplete:p}=e;const[f,m]=(0,o.useState)(""),[y,w]=(0,o.useState)([]),[b,v]=(0,o.useState)([]),[S,C]=(0,o.useState)({message:"",type:""}),[k,j]=(0,o.useState)(!0),[A,N]=(0,o.useState)(null),[T,E]=(0,o.useState)(!1),[R,$]=(0,o.useState)(!1),{isLatinized:O}=(0,a.te)(),W=i.A,{t:I}=(0,n.s)(),z=W(f,r),B=(0,o.useCallback)(async()=>{j(!0),N(null),C({message:"",type:""}),E(!1),$(!1),m(""),w([]),v([]);try{const{data:e,error:o}=await(0,s.Vu)(r,t);if(o)throw new Error(o.message||o.error||"Failed to load vocabulary words.");if(e&&e.length>0){let r;const t=e.filter(e=>!e.includes(" ")&&e.length>2&&e.length<15);if(t.length>0)r=t[Math.floor(Math.random()*t.length)];else if(r=e[Math.floor(Math.random()*e.length)].split(" ")[0],r.length<=2||r.length>=15)return N(I("exercises.noSuitableWordBuild",'Could not find a suitable word (3-14 letters, no spaces) for "Build Word" exercise.')),void j(!1);m(r),v(Array(r.length).fill({char:null,originalTileId:null})),w(g(r.split("").map((e,r)=>({char:e,id:r,inSlot:!1,slotIndex:null}))))}else N(I("exercises.noWordsFound","No vocabulary words found for the selected criteria."))}catch(e){console.error("BuildWordExercise - Error fetching word:",e),N(e.message||I("errors.unexpectedError","An unexpected error occurred."))}finally{j(!1)}},[r,t,I]);(0,o.useEffect)(()=>{r&&t&&t.length>0?B():(j(!1),N(I("errors.selectLangDay","Please select a language and day(s).")))},[B,c,r,t,I]);const Y=e=>{if(T||R||!b[e]||null===b[e].char)return;const r=b[e].originalTileId,t=[...b];t[e]={char:null,originalTileId:null},v(t);const o=y.map(e=>e.id===r?{...e,inSlot:!1,slotIndex:null}:e);w(o),C({message:"",type:""})},L=()=>{p?p():B()};return k?(0,d.jsx)("p",{children:I("loading.buildWordExercise","Loading word building exercise...")}):A?(0,d.jsxs)("div",{className:"build-word-exercise-container",children:[(0,d.jsx)(h,{message:A,type:"error"}),(0,d.jsx)(u,{onNextExercise:L,config:{showNext:!0}})]}):f||k?(0,d.jsxs)("div",{className:"build-word-exercise-container",children:[(0,d.jsx)("h3",{children:I("titles.buildTheWord","Build the Word")}),(0,d.jsx)("button",{onClick:()=>(0,l.x$)(f,r),disabled:!f,title:I("tooltips.pronounceWord","Pronounce the word"),className:"pronounce-button-bwe",children:"\ud83d\udd0a"}),(0,d.jsx)("div",{className:"word-slots-area",children:b.map((e,t)=>(0,d.jsx)("div",{className:"word-slot "+(e.char?"filled-slot":"empty-slot"),onClick:()=>Y(t),children:e.char?(0,d.jsx)("span",{className:"slot-char "+(O&&e.char!==W(e.char,r)?"latinized-char":""),children:W(e.char,r)}):(0,d.jsx)("span",{className:"slot-placeholder",children:"?"})},`slot-${t}`))}),(0,d.jsxs)("div",{className:"letter-pool-area",children:[y.filter(e=>!e.inSlot).map(e=>(0,d.jsx)("button",{className:"letter-tile",onClick:()=>(e=>{if(T||R||e.inSlot)return;const r=[...b],t=r.findIndex(e=>null===e.char);if(-1!==t){r[t]={char:e.char,originalTileId:e.id},v(r);const o=y.map(r=>r.id===e.id?{...r,inSlot:!0,slotIndex:t}:r);w(o),C({message:"",type:""})}})(e),disabled:T||R,children:(0,d.jsx)("span",{className:O&&e.char!==W(e.char,r)?"latinized-char":"",children:W(e.char,r)})},`tile-${e.id}`)),0===y.filter(e=>!e.inSlot).length&&!R&&!T&&(0,d.jsx)("span",{className:"all-letters-placed-message",children:I("feedback.allLettersPlaced","All letters placed! Check your word.")})]}),(0,d.jsx)(h,{message:S.message,type:S.type,language:r}),(0,d.jsx)(u,{onCheckAnswer:!T&&!R&&b.every(e=>e.char)&&f?()=>{if(T||R||!f)return;x(b.map(e=>e.char).join(""))===x(f)?(C({message:I("feedback.correct","Correct!"),type:"correct"}),$(!0),p&&setTimeout(()=>p(),1500)):C({message:I("feedback.incorrectKeepTrying","Incorrect. Keep trying or use a hint."),type:"incorrect"})}:void 0,onShowHint:T||R||!f?void 0:()=>{if(T||R||!f)return;let e=-1;const t=b.map(e=>e.char).join("");for(let r=0;r<f.length;r++)if(!b[r]||!b[r].char||x(b[r].char)!==x(f[r])){e=r;break}if(-1===e&&t.length<f.length&&(e=t.length),-1!==e){const t=f[e];b[e]&&b[e].char&&x(b[e].char)!==x(t)&&Y(e);const o=y.find(e=>!e.inSlot&&x(e.char)===x(t));if(o){const n=[...b];n[e]={char:o.char,originalTileId:o.id},v(n),w(r=>r.map(r=>r.id===o.id?{...r,inSlot:!0,slotIndex:e}:r)),C({message:I("feedback.hintLetterPlaced",`Hint: Letter "${W(t,r)}" placed.`,{letter:W(t,r)}),type:"hint"})}else C({message:I("feedback.hintLetterMisplaced","Hint: Could not find the next correct letter in the pool (it might be misplaced)."),type:"info"})}else C({message:I("feedback.hintWordCorrectOrNoMore","Word seems correct or no more hints applicable."),type:"info"})},onRevealAnswer:T||R||!f?void 0:()=>{f&&(v(f.split("").map((e,r)=>({char:e,originalTileId:-1-r}))),w(y.map(e=>({...e,inSlot:!0,slotIndex:f.indexOf(e.char)}))),C({message:I("feedback.answerIs",`The word is: ${z||f}`,{answer:z||f}),type:"info"}),E(!0),$(!0),p&&setTimeout(()=>p(),2e3))},onNextExercise:L,config:{showCheck:!T&&!R&&b.every(e=>e.char)&&!!f,showHint:!T&&!R&&!!f,showReveal:!T&&!R&&!!f,showNext:!0}}),(0,d.jsxs)("button",{onClick:()=>{!f||T||R||(v(Array(f.length).fill({char:null,originalTileId:null})),w(g(f.split("").map((e,r)=>({char:e,id:r,inSlot:!1,slotIndex:null})))),C({message:"",type:""}))},className:"reset-tiles-button",disabled:T||R||!f,children:["\ud83d\udd04 ",I("buttons.resetTiles","Reset Tiles")]})]}):(0,d.jsxs)("div",{className:"build-word-exercise-container",children:[(0,d.jsx)(h,{message:I("exercises.noWordForBuild","No word available for this exercise."),type:"info"}),(0,d.jsx)(u,{onNextExercise:L,config:{showNext:!0}})]})},name:"Build Word"}],m=e=>{let{language:r,days:t,exerciseKey:s}=e;const{t:a}=(0,n.s)(),[i,l]=(0,o.useState)(null),[c,u]=(0,o.useState)(null),[h,p]=(0,o.useState)(0),[g,x]=(0,o.useState)(!0),m=(0,o.useCallback)(()=>{x(!0);const e=Math.floor(Math.random()*f.length),r=f[e];console.log(`RandomWordPracticeHost: Selecting exercise type: ${r.name}`),u(r),l(()=>r.Component),p(e=>e+1),x(!1)},[]);(0,o.useEffect)(()=>{console.log(`RandomWordPracticeHost: hostKey changed to ${s}, selecting new initial exercise.`),m()},[s,m]);const y=(0,o.useCallback)(()=>{console.log(`RandomWordPracticeHost: Sub-exercise ${null===c||void 0===c?void 0:c.name} completed. Selecting next one.`),setTimeout(()=>{m()},500)},[m,c]);return g||!i?(0,d.jsx)("p",{children:a("loading.randomWordExercise","Loading Random Word Exercise...")}):(0,d.jsx)("div",{className:"random-word-practice-host-container cosy-exercise-container",children:(0,d.jsx)(i,{language:r,days:t,exerciseKey:h,onComplete:y})})}},6951:(e,r,t)=>{async function o(e){try{const t=`/COSYlanguagesproject${e}`,o=await fetch(t);if(!o.ok){const r=`HTTP error ${o.status} while fetching ${e}`;return console.error(r),404===o.status?{data:null,error:`File not found: ${e}`,errorType:"fileNotFound"}:{data:null,error:`Failed to load data: ${r}`,errorType:"httpError"}}try{return{data:await o.json(),error:null,errorType:null}}catch(r){return console.error(`Error parsing JSON from ${e}:`,r),{data:null,error:"Invalid JSON format",errorType:"jsonError"}}}catch(t){return console.error(`Network error or other exception while loading data from ${e}:`,t),{data:null,error:`Network error: ${t.message}`,errorType:"networkError"}}}t.d(r,{Dj:()=>o,Qe:()=>s,Vu:()=>i,nN:()=>d,pC:()=>l,uK:()=>c});const n={COSYenglish:"en",COSYfrench:"fr","COSYespa\xf1ol":"es",COSYitalian:"it",COSYdeutsch:"de",COSYportugese:"pt",COSYgreek:"el",COSYrussian:"ru",COSYarmenian:"hy",COSYbrezhoneg:"br",COSYtatar:"tt",COSYbachkir:"ba"};function s(e){return n[e]||"english"}function a(e,r){if(!e)return Array.isArray(r)?[]:{};let t;return Array.isArray(r)?(t=[],r.forEach(r=>{e[r]&&(t=t.concat(e[r]))})):t="string"===typeof r||"number"===typeof r?e[r]||("object"!==typeof e||Array.isArray(e)?[]:{}):e,t}async function i(e,r){const t=`/data/vocabulary/words/${s(e)}.json`,{data:n,error:i,errorType:l}=await o(t);return i?{data:[],error:i,errorType:l}:{data:a(n,r),error:null,errorType:null}}async function l(e,r){const t=`/data/vocabulary/opposites/${s(e)}.json`,{data:n,error:i,errorType:l}=await o(t);if(i)return{data:{},error:i,errorType:l};const c=a(n,r);if(Array.isArray(r)&&Array.isArray(c)){return{data:c.reduce((e,r)=>({...e,...r}),{}),error:null,errorType:null}}return{data:c,error:null,errorType:null}}async function c(e){const r="/data/exercises/sentenceUnscramble.json",{data:t,error:n,errorType:s}=await o(r);return n?{data:[],error:n,errorType:s}:t&&t[e]?{data:t[e],error:null,errorType:null}:(console.warn(`Sentence unscramble data for language ${e} not found in ${r}.`),{data:[],error:`No sentence unscramble data for ${e}.`,errorType:"dataNotFound"})}async function d(e){const r="/data/exercises/fillInTheBlanks.json",{data:t,error:n,errorType:s}=await o(r);return n?{data:[],error:n,errorType:s}:t&&t[e]?{data:t[e],error:null,errorType:null}:(console.warn(`Fill in the Blanks data for language ${e} not found in ${r}.`),{data:[],error:`No Fill in the Blanks data for ${e}.`,errorType:"dataNotFound"})}console.log("[ExerciseDataService] Service loaded.")}}]);
//# sourceMappingURL=640.56aaf68d.chunk.js.map