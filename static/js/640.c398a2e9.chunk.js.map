{"version":3,"file":"static/js/640.c398a2e9.chunk.js","mappings":"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","sources":["components/Freestyle/ExerciseControls.js","components/Freestyle/FeedbackDisplay.js","utils/arrayUtils.js","utils/stringUtils.js","components/Freestyle/exercises/vocabulary/MatchOppositesExercise.js","components/Freestyle/exercises/vocabulary/RandomWordPracticeHost.js","components/Freestyle/exercises/vocabulary/ShowWordExercise.js","components/Freestyle/exercises/vocabulary/TypeOppositeExercise.js","components/Freestyle/exercises/vocabulary/BuildWordExercise.js"],"sourcesContent":["import React from 'react';\nimport { useI18n } from '../../i18n/I18nContext';\nimport Button from '../Common/Button'; // Import Button\nimport './ExerciseControls.css';\n\nconst ExerciseControls = ({\n  onCheckAnswer,\n  onRevealAnswer,\n  onShowHint,\n  onRandomize,\n  onNextExercise,\n  config = {},\n  isAnswerCorrect = false,\n  isRevealed = false,\n  customButton = null\n}) => {\n  const { t } = useI18n();\n\n  const {\n    showCheck = !!onCheckAnswer,\n    checkButtonText = t('buttons.check', '✔️ Check'),\n    showReveal = !!onRevealAnswer,\n    revealButtonText = t('buttons.revealAnswer', '🤫 Reveal Answer'),\n    showHint = !!onShowHint,\n    hintButtonText = t('buttons.help', '💡 Hint'),\n    showRandomize = !!onRandomize,\n    randomizeButtonText = t('buttons.randomize', '🎲 Randomize'),\n    showNext = !!onNextExercise,\n    nextButtonText = t('buttons.next', '➡️ Next Exercise'),\n  } = config;\n\n  const canInteract = !isAnswerCorrect && !isRevealed;\n\n  return (\n    <div className=\"exercise-action-buttons\">\n      {showHint && onShowHint && (\n        <Button\n          onClick={onShowHint}\n          disabled={!canInteract}\n          className=\"button--warning\"\n        >\n          {hintButtonText}\n        </Button>\n      )}\n      {showRandomize && onRandomize && (\n        <Button\n          onClick={onRandomize}\n          disabled={!canInteract && !showNext}\n          className=\"button--secondary\"\n        >\n          {randomizeButtonText}\n        </Button>\n      )}\n      {showCheck && onCheckAnswer && (\n        <Button\n          onClick={onCheckAnswer}\n          disabled={!canInteract}\n          className=\"button--success\"\n        >\n          {checkButtonText}\n        </Button>\n      )}\n      {showReveal && onRevealAnswer && (\n        <Button\n          onClick={onRevealAnswer}\n          disabled={!canInteract}\n          className=\"button--info\"\n        >\n          {revealButtonText}\n        </Button>\n      )}\n      {customButton}\n      {showNext && onNextExercise && (\n        <Button\n          onClick={onNextExercise}\n          className=\"\"\n        >\n          {nextButtonText}\n        </Button>\n      )}\n    </div>\n  );\n};\n\nexport default ExerciseControls;\n","import React from 'react';\r\nimport { useLatinizationContext } from '../../contexts/LatinizationContext';\r\nimport useLatinization from '../../hooks/useLatinization';\r\n\r\n/**\r\n * Displays feedback messages for exercises.\r\n * Props:\r\n * - message: string or React node - The feedback message.\r\n * - type: string (e.g., 'correct', 'incorrect', 'hint', 'info', 'error') - Determines styling.\r\n * - language: string (optional) - The language of the feedback message, for latinization.\r\n */\r\nconst FeedbackDisplay = ({ message, type, language }) => {\r\n  // Call the useLatinization hook unconditionally at the top level.\r\n  // Pass an empty string if message is not a string to prevent errors in the hook.\r\n  // The hook itself is expected to use LatinizationContext to determine if latinization is active.\r\n  const latinizedVersion = useLatinization(typeof message === 'string' ? message : '', language);\r\n\r\n  // Determine the actual message to display.\r\n  // If the original message was not a string, or no language was provided, use the original message.\r\n  // Otherwise, use the output from useLatinization (which respects the isLatinized context).\r\n  const processedMessage = (typeof message === 'string' && language)\r\n    ? latinizedVersion\r\n    : message;\r\n\r\n  // Get isLatinized from context, primarily for UI adjustments like font style,\r\n  // not for deciding whether to call useLatinization.\r\n  const { isLatinized } = useLatinizationContext();\r\n\r\n  if (!message) {\r\n    return <div style={{ minHeight: '24px', margin: '10px 0' }} aria-live=\"polite\"></div>; // Reserve space\r\n  }\r\n\r\n  let style = {\r\n    padding: '15px',\n    margin: '10px 0',\r\n    borderRadius: '8px',\n    textAlign: 'center',\r\n    minHeight: '24px', // Ensure it doesn't collapse when empty\r\n    fontWeight: 'bold',\n    animation: 'fadeIn 0.5s ease-in-out'\n  };\r\n\n  if (type === 'correct') {\n    style.animation = 'correct-answer-animation 0.5s ease-in-out';\n  }\n\r\n  let textPrefix = '';\r\n\r\n  switch (type) {\r\n    case 'correct':\r\n      style.backgroundColor = 'var(--color-success-bg)';\n      style.color = 'var(--color-success-text)';\n      style.borderColor = 'var(--color-success-border)';\n      textPrefix = '🎉 ';\n      break;\r\n    case 'incorrect':\r\n      style.backgroundColor = 'var(--color-danger-bg)';\n      style.color = 'var(--color-danger-text)';\n      style.borderColor = 'var(--color-danger-border)';\n      textPrefix = '🤔 ';\n      break;\r\n    case 'hint':\r\n      style.backgroundColor = 'var(--color-warning-bg)';\n      style.color = 'var(--color-warning-text)';\n      style.borderColor = 'var(--color-warning-border)';\n      textPrefix = '💡 ';\r\n      break;\r\n    case 'info':\r\n      style.backgroundColor = 'var(--color-info-bg)';\n      style.color = 'var(--color-info-text)';\n      style.borderColor = 'var(--color-info-border)';\n      textPrefix = 'ℹ️ ';\r\n      break;\r\n    case 'error':\r\n      style.backgroundColor = 'var(--color-danger-bg)'; // Same as incorrect\n      style.color = 'var(--color-danger-text)';\n      style.borderColor = 'var(--color-danger-border)';\n      textPrefix = '⚠️ ';\r\n      break;\r\n    default: // Neutral / no specific type\r\n      style.backgroundColor = 'var(--color-surface-medium)';\n      style.color = 'var(--color-text-primary)';\n      style.borderColor = 'var(--color-border)';\n  }\r\n  \r\n  // Apply visual indication for latinized text if necessary\r\n  if (isLatinized && typeof processedMessage === 'string' && typeof message === 'string' && processedMessage !== message) {\r\n    style.fontStyle = 'italic'; \r\n    // style.fontFamily = 'Arial, sans-serif'; // Example alternative font\r\n  }\r\n\r\n  return (\r\n    <div style={style} role=\"alert\" aria-live=\"assertive\">\r\n      {textPrefix}{processedMessage}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FeedbackDisplay;\r\n","/**\n * Shuffles an array in place and returns a new shuffled array.\n * This is a pure function that does not modify the original array.\n * @param {Array} array - The array to shuffle.\n * @returns {Array} A new array with the elements randomly shuffled.\n */\nexport function shuffleArray(array) {\n  const newArray = [...array];\n  for (let i = newArray.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [newArray[i], newArray[j]] = [newArray[j], newArray[i]];\n  }\n  return newArray;\n}\n\n/**\n * Selects a random item from an array of items, where each item has a weight.\n * @param {Array<{item: any, weight: number}>} itemsWithWeights - An array of objects,\n * each with an 'item' and its 'weight'.\n * @returns {any|null} The selected item, or null if the input is invalid or empty.\n */\nexport function getWeightedRandomItem(itemsWithWeights) {\n  if (!itemsWithWeights || itemsWithWeights.length === 0) {\n    return null;\n  }\n\n  const totalWeight = itemsWithWeights.reduce((sum, entry) => sum + (entry.weight || 0), 0);\n  if (totalWeight <= 0) {\n    // If the total weight is 0 or less, fall back to a uniform random selection.\n    const originalItems = itemsWithWeights.map(iw => iw.item);\n    return originalItems.length > 0 ? originalItems[Math.floor(Math.random() * originalItems.length)] : null;\n  }\n\n  let randomValue = Math.random() * totalWeight;\n  for (let i = 0; i < itemsWithWeights.length; i++) {\n    if (randomValue < (itemsWithWeights[i].weight || 0)) {\n      return itemsWithWeights[i].item;\n    }\n    randomValue -= (itemsWithWeights[i].weight || 0);\n  }\n\n  // Fallback in case of rounding errors or other unexpected scenarios.\n  const originalItems = itemsWithWeights.map(iw => iw.item);\n  return originalItems.length > 0 ? originalItems[Math.floor(Math.random() * originalItems.length)] : null;\n}\n","/**\n * Normalizes a string by converting it to lowercase, removing diacritics, and standardizing apostrophes.\n * @param {string} str - The string to normalize.\n * @returns {string} The normalized string.\n */\nexport function normalizeString(str) {\n  if (str === null || str === undefined) {\n    return '';\n  }\n  let normalized = String(str).normalize('NFD').replace(/[\\u0300-\\u036f]/g, '').toLowerCase();\n  normalized = normalized.replace(/[’‘ʼ]/g, \"'\");\n  return normalized;\n}\n\n/**\n * Capitalizes the first letter of a word.\n * @param {string} word - The word to capitalize.\n * @param {boolean} [forceLowerCaseRest=true] - Whether to convert the rest of the word to lowercase.\n * @param {string} [lang='COSYenglish'] - The language of the word.\n * @returns {string} The capitalized word.\n */\nexport function capitalizeWord(word, forceLowerCaseRest = true, lang = 'COSYenglish') {\n  if (typeof word !== 'string' || word.length === 0) {\n    return word;\n  }\n  if (lang === 'COSYenglish' && word.toLowerCase() === 'i') {\n    return 'I';\n  }\n  const firstLetter = word.charAt(0).toUpperCase();\n  const rest = forceLowerCaseRest ? word.slice(1).toLowerCase() : word.slice(1);\n  return firstLetter + rest;\n}\n\n/**\n * Escapes special characters in a string for use in a regular expression.\n * @param {string} string - The string to escape.\n * @returns {string} The escaped string.\n */\nexport function escapeRegExp(string) {\n  if (typeof string !== 'string') return '';\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { loadOppositesData } from '../../../../utils/exerciseDataService';\r\nimport FeedbackDisplay from '../../FeedbackDisplay';\r\nimport ExerciseControls from '../../ExerciseControls';\r\nimport { useLatinizationContext } from '../../../../contexts/LatinizationContext';\r\nimport useLatinization from '../../../../hooks/useLatinization';\r\nimport { shuffleArray } from '../../../../utils/arrayUtils';\r\nimport { normalizeString } from '../../../../utils/stringUtils';\r\n\r\nconst MatchOppositesExercise = ({ language, days, exerciseKey }) => {\r\n  const [pairs, setPairs] = useState([]);\r\n  const [wordsColumn, setWordsColumn] = useState([]);\r\n  const [oppositesColumn, setOppositesColumn] = useState([]);\r\n  const [selectedWord, setSelectedWord] = useState(null); // { value: string, element: HTMLElement }\r\n  const [selectedOpposite, setSelectedOpposite] = useState(null); // { value: string, element: HTMLElement }\r\n  const [matchedItems, setMatchedItems] = useState({}); // { [itemValue]: true }\r\n  const [feedback, setFeedback] = useState({ message: '', type: '' });\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [numCorrectMatches, setNumCorrectMatches] = useState(0);\r\n  const [isRevealed, setIsRevealed] = useState(false);\r\n  const [lines, setLines] = useState([]); // For drawing lines between matched items\r\n\r\n  // const { isLatinized } = useLatinizationContext(); // This instance of isLatinized is unused.\r\n  useLatinizationContext(); // Called to satisfy rules-of-hooks, assuming other context values might be used later or were used before.\r\n  const getLatinizedText = useLatinization;\r\n\r\n  const itemRefs = useRef({}); // To store refs for each matchable item\r\n  const columnsContainerRef = useRef(null); // Ref for the div containing both columns\r\n\r\n  const NUM_PAIRS_TO_DISPLAY = 4;\r\n\r\n  const setupExercise = useCallback(async () => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n    setFeedback({ message: '', type: '' });\r\n    setSelectedWord(null);\r\n    setSelectedOpposite(null);\r\n    setMatchedItems({});\r\n    setNumCorrectMatches(0);\r\n    setIsRevealed(false);\r\n    setLines([]); // Clear lines\r\n    itemRefs.current = {}; // Clear old refs\r\n\r\n    try {\r\n      const { data: oppositesMap, error: fetchError } = await loadOppositesData(language, days);\r\n      if (fetchError) {\r\n        throw new Error(fetchError.message || fetchError.error || 'Failed to load opposites data.');\r\n      }\r\n\r\n      if (!oppositesMap || Object.keys(oppositesMap).length < NUM_PAIRS_TO_DISPLAY / 2) {\r\n        setError(`Not enough opposites data (found ${Object.keys(oppositesMap).length}) for this exercise. Need at least ${NUM_PAIRS_TO_DISPLAY / 2} base pairs.`);\r\n        setPairs([]);\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      const allPossiblePairs = Object.entries(oppositesMap).map(([word, opposite]) => ({ word, opposite }));\r\n      const shuffledPossiblePairs = shuffleArray(allPossiblePairs);\r\n      const selectedPairs = shuffledPossiblePairs.slice(0, NUM_PAIRS_TO_DISPLAY);\r\n\r\n      if (selectedPairs.length < 1) {\r\n        setError('Could not select enough unique pairs for the exercise.');\r\n        setPairs([]);\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      setPairs(selectedPairs);\r\n      setWordsColumn(shuffleArray(selectedPairs.map(p => p.word)));\r\n      setOppositesColumn(shuffleArray(selectedPairs.map(p => p.opposite)));\r\n\r\n    } catch (err) {\r\n      console.error(\"MatchOppositesExercise - Error setting up exercise:\", err);\r\n      setError(err.message || 'An unexpected error occurred.');\r\n      setPairs([]);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [language, days]);\r\n\r\n  useEffect(() => {\r\n    if (language && days && days.length > 0) {\r\n      setupExercise();\r\n    } else {\r\n      setIsLoading(false);\r\n      setError(\"Please select a language and day(s).\");\r\n    }\r\n  }, [setupExercise, exerciseKey, language, days]);\r\n\r\n  const handleItemClick = (itemValue, type, event) => {\r\n    if (matchedItems[itemValue] || isRevealed) return;\r\n\r\n    const currentSelection = { value: itemValue, element: event.target };\r\n\r\n    if (type === 'word') {\r\n      if (selectedWord && selectedWord.element === event.target) {\r\n        setSelectedWord(null); // Deselect if clicking the same selected item\r\n        // event.target.classList.remove('selected'); // classList managed by style logic\r\n        return;\r\n      }\r\n      // if(selectedWord && selectedWord.element) selectedWord.element.classList.remove('selected');\r\n      setSelectedWord(currentSelection);\r\n      // event.target.classList.add('selected');\r\n    } else if (type === 'opposite') {\r\n      if (selectedOpposite && selectedOpposite.element === event.target) {\r\n        setSelectedOpposite(null); // Deselect\r\n        // event.target.classList.remove('selected');\r\n        return;\r\n      }\r\n      // if(selectedOpposite && selectedOpposite.element) selectedOpposite.element.classList.remove('selected');\r\n      setSelectedOpposite(currentSelection);\r\n      // event.target.classList.add('selected');\r\n    }\r\n  };\r\n\r\n  const drawLine = useCallback((el1, el2) => {\r\n    if (!el1 || !el2 || !columnsContainerRef.current) return;\r\n\r\n    const containerRect = columnsContainerRef.current.getBoundingClientRect();\r\n    const rect1 = el1.getBoundingClientRect();\r\n    const rect2 = el2.getBoundingClientRect();\r\n\r\n    const x1 = rect1.left + rect1.width / 2 - containerRect.left + columnsContainerRef.current.scrollLeft;\r\n    const y1 = rect1.top + rect1.height / 2 - containerRect.top + columnsContainerRef.current.scrollTop;\r\n    const x2 = rect2.left + rect2.width / 2 - containerRect.left + columnsContainerRef.current.scrollLeft;\r\n    const y2 = rect2.top + rect2.height / 2 - containerRect.top + columnsContainerRef.current.scrollTop;\r\n    \r\n    const lineKey = `line-${normalizeString(el1.textContent)}-${normalizeString(el2.textContent)}`;\r\n    setLines(prevLines => [...prevLines, { x1, y1, x2, y2, key: lineKey }]);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (selectedWord && selectedOpposite) {\r\n      const currentWordValue = selectedWord.value;\r\n      const currentOppositeValue = selectedOpposite.value;\r\n      const isCorrectMatch = pairs.some(pair =>\r\n        (pair.word === currentWordValue && pair.opposite === currentOppositeValue)\r\n      );\r\n      // const itemId = `matchopposite_${normalizeString(currentWordValue)}_${normalizeString(currentOppositeValue)}`; // ESLint: 'itemId' is assigned a value but never used.\r\n\r\n      if (isCorrectMatch) {\r\n        setFeedback({ message: 'Correct Match!', type: 'correct' });\r\n        setMatchedItems(prev => ({ ...prev, [currentWordValue]: true, [currentOppositeValue]: true }));\r\n        \r\n        if (selectedWord.element && selectedOpposite.element) {\r\n          drawLine(selectedWord.element, selectedOpposite.element);\r\n        }\r\n        \r\n        setNumCorrectMatches(prev => prev + 1);\r\n        \r\n        setSelectedWord(null); // Clear selections immediately after correct match\r\n        setSelectedOpposite(null);\r\n\r\n      } else {\r\n        setFeedback({ message: 'Incorrect Match. Try again.', type: 'incorrect' });\r\n        \r\n        // Visual feedback for incorrect (e.g., flash border red)\r\n        if(selectedWord.element) selectedWord.element.classList.add('incorrect-flash');\r\n        if(selectedOpposite.element) selectedOpposite.element.classList.add('incorrect-flash');\r\n        \r\n        setTimeout(() => {\r\n            if(selectedWord && selectedWord.element) selectedWord.element.classList.remove('incorrect-flash');\r\n            if(selectedOpposite && selectedOpposite.element) selectedOpposite.element.classList.remove('incorrect-flash');\r\n            setSelectedWord(null);\r\n            setSelectedOpposite(null);\r\n        }, 1000);\r\n      }\r\n    }\r\n  }, [selectedWord, selectedOpposite, pairs, drawLine]);\r\n\r\n  useEffect(() => {\r\n    if (pairs.length > 0 && numCorrectMatches === pairs.length && !isRevealed) {\r\n      setFeedback({ message: 'All pairs matched! Well done!', type: 'success' });\r\n    }\r\n  }, [numCorrectMatches, pairs.length, isRevealed]);\r\n\r\n  const showHint = () => {\r\n    if (isRevealed || numCorrectMatches === pairs.length) return;\r\n    const unMatchedPairs = pairs.filter(p => !matchedItems[p.word] && !matchedItems[p.opposite]);\r\n    if (unMatchedPairs.length > 0) {\r\n      const hintPair = unMatchedPairs[0];\r\n      setFeedback({ message: `Hint: Try matching \"${getLatinizedText(hintPair.word, language)}\" or \"${getLatinizedText(hintPair.opposite, language)}\".`, type: 'hint' });\r\n    } else {\r\n      setFeedback({ message: \"No more hints available.\", type: 'info' });\r\n    }\r\n  };\r\n\r\n  const revealAllAnswers = () => {\r\n    setIsRevealed(true);\r\n    const allCurrentlyMatched = {};\r\n    const linesForRevealed = []; \r\n    pairs.forEach(pair => {\r\n      allCurrentlyMatched[pair.word] = true;\r\n      allCurrentlyMatched[pair.opposite] = true;\r\n\r\n      const el1 = itemRefs.current[`word-${pair.word}`];\r\n      const el2 = itemRefs.current[`opposite-${pair.opposite}`];\r\n      if (el1 && el2 && columnsContainerRef.current) {\r\n        const containerRect = columnsContainerRef.current.getBoundingClientRect();\r\n        const rect1 = el1.getBoundingClientRect();\r\n        const rect2 = el2.getBoundingClientRect();\r\n        const x1 = rect1.left + rect1.width / 2 - containerRect.left + columnsContainerRef.current.scrollLeft;\r\n        const y1 = rect1.top + rect1.height / 2 - containerRect.top + columnsContainerRef.current.scrollTop;\r\n        const x2 = rect2.left + rect2.width / 2 - containerRect.left + columnsContainerRef.current.scrollLeft;\r\n        const y2 = rect2.top + rect2.height / 2 - containerRect.top + columnsContainerRef.current.scrollTop;\r\n        linesForRevealed.push({ x1, y1, x2, y2, key: `line-${normalizeString(pair.word)}-${normalizeString(pair.opposite)}` });\r\n      }\r\n    });\r\n    setMatchedItems(allCurrentlyMatched);\r\n    setLines(linesForRevealed); // Use the new variable here\r\n    setNumCorrectMatches(pairs.length);\r\n    setFeedback({ message: \"All pairs revealed.\", type: 'info' });\r\n  };\r\n\r\n  if (isLoading) return <p>Loading matching exercise...</p>;\r\n  if (error) return <FeedbackDisplay message={error} type=\"error\" />;\r\n  if (pairs.length === 0 && !isLoading) return <FeedbackDisplay message=\"No pairs available for this exercise.\" type=\"info\" />;\r\n\r\n  const columnStyle = { display: 'flex', flexDirection: 'column', gap: '8px', alignItems: 'center', margin: '0 15px', flex: 1 };\r\n  const itemStyle = (value, type) => {\r\n    let base = {\r\n      padding: '12px 18px',\r\n      border: '2px solid #ddd',\r\n      borderRadius: '8px',\r\n      cursor: 'pointer',\r\n      minWidth: '150px',\r\n      textAlign: 'center',\r\n      backgroundColor: '#fff',\r\n      transition: 'background-color 0.2s, border-color 0.2s, transform 0.1s',\r\n      boxShadow: '0 1px 3px rgba(0,0,0,0.05)',\r\n    };\r\n    if (matchedItems[value]) {\r\n      base.backgroundColor = '#e6ffed';\r\n      base.borderColor = '#b7eac9';\r\n      base.cursor = 'default';\r\n      base.fontWeight = 'bold';\r\n    } else if ((type === 'word' && selectedWord?.value === value) || (type === 'opposite' && selectedOpposite?.value === value)) {\r\n      base.backgroundColor = '#e0efff';\r\n      base.borderColor = '#90caf9';\r\n      base.transform = 'scale(1.03)';\r\n    }\r\n    return base;\r\n  };\r\n\r\n  return (\r\n    <div style={{ textAlign: 'center', padding: '20px', border: '1px solid #eee', borderRadius: '8px', maxWidth: '600px', margin: 'auto' }}>\r\n      <h3>Match the Opposites</h3>\r\n      <div \r\n        ref={columnsContainerRef} \r\n        style={{ display: 'flex', justifyContent: 'center', margin: '20px 0', position: 'relative' }}\r\n      >\r\n        <svg \r\n          style={{ \r\n            position: 'absolute', top: 0, left: 0, \r\n            width: '100%', height: '100%', \r\n            pointerEvents: 'none', zIndex: 0 \r\n          }}\r\n        >\r\n          {lines.map(line => (\r\n            <line \r\n              key={line.key} \r\n              x1={line.x1} y1={line.y1} \r\n              x2={line.x2} y2={line.y2} \r\n              stroke=\"#28a745\" strokeWidth=\"3\" opacity=\"0.7\"\r\n            />\r\n          ))}\r\n        </svg>\r\n        <div style={{...columnStyle, zIndex: 1}}> {/* Ensure columns are above SVG lines */}\r\n          <h4>Words</h4>\r\n          {wordsColumn.map(word => (\r\n            <button\r\n              key={`word-${word}`}\r\n              ref={el => itemRefs.current[`word-${word}`] = el}\r\n              style={itemStyle(word, 'word')}\r\n              onClick={(e) => handleItemClick(word, 'word', e)}\r\n              disabled={matchedItems[word] || isRevealed}\r\n              className={ (selectedWord?.value === word && !matchedItems[word]) ? 'selected-match-item' : '' }\r\n            >\r\n              {getLatinizedText(word, language)}\r\n            </button>\r\n          ))}\r\n        </div>\r\n        <div style={{...columnStyle, zIndex: 1}}>\r\n          <h4>Opposites</h4>\r\n          {oppositesColumn.map(opposite => (\r\n            <button\r\n              key={`opp-${opposite}`}\r\n              ref={el => itemRefs.current[`opposite-${opposite}`] = el}\r\n              style={itemStyle(opposite, 'opposite')}\r\n              onClick={(e) => handleItemClick(opposite, 'opposite', e)}\r\n              disabled={matchedItems[opposite] || isRevealed}\r\n              className={ (selectedOpposite?.value === opposite && !matchedItems[opposite]) ? 'selected-match-item' : '' }\r\n            >\r\n              {getLatinizedText(opposite, language)}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n      <FeedbackDisplay message={feedback.message} type={feedback.type} language={language} />\r\n      <ExerciseControls\r\n        onShowHint={!isRevealed && numCorrectMatches < pairs.length ? showHint : undefined}\r\n        onRevealAnswer={!isRevealed && numCorrectMatches < pairs.length ? revealAllAnswers : undefined}\r\n        onNextExercise={setupExercise}\r\n        config={{\r\n          showCheck: false,\r\n          showHint: !isRevealed && numCorrectMatches < pairs.length && pairs.length > 0,\r\n          showReveal: !isRevealed && numCorrectMatches < pairs.length && pairs.length > 0,\r\n          showNext: true,\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MatchOppositesExercise;\r\n","// @ts-check\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useI18n } from '../../../../i18n/I18nContext';\n\n// Import the specific exercise components this host will manage\nimport ShowWordExercise from './ShowWordExercise';\nimport TypeOppositeExercise from './TypeOppositeExercise';\nimport MatchOppositesExercise from './MatchOppositesExercise';\nimport BuildWordExercise from './BuildWordExercise';\n\nconst managedExerciseComponents = [\n  { key: 'show_word', Component: ShowWordExercise, name: 'Show Word' },\n  { key: 'type_opposite', Component: TypeOppositeExercise, name: 'Type Opposite' },\n  { key: 'match_opposites', Component: MatchOppositesExercise, name: 'Match Opposites' },\n  { key: 'build_word', Component: BuildWordExercise, name: 'Build Word' },\n];\n\nconst RandomWordPracticeHost = ({ language, days, exerciseKey: hostKey }) => {\n  const { t } = useI18n();\n  const [CurrentExercise, setCurrentExercise] = useState(null);\n  const [currentExerciseInfo, setCurrentExerciseInfo] = useState(null);\n  const [subExerciseKey, setSubExerciseKey] = useState(0);\n  const [isLoading, setIsLoading] = useState(true);\n\n  const selectAndLoadRandomExercise = useCallback(() => {\n    setIsLoading(true);\n    const randomIndex = Math.floor(Math.random() * managedExerciseComponents.length);\n    const selected = managedExerciseComponents[randomIndex];\n    \n    console.log(`RandomWordPracticeHost: Selecting exercise type: ${selected.name}`);\n    setCurrentExerciseInfo(selected);\n    setCurrentExercise(() => selected.Component); // Store the component constructor\n    setSubExerciseKey(prev => prev + 1);\n    setIsLoading(false);\n  }, []); // No dependencies needed here as it's meant to be called to reset\n\n  useEffect(() => {\n    // This effect runs when the hostKey (passed from ExerciseHost) changes,\n    // or on initial mount. It signifies a new \"session\" for this host.\n    console.log(`RandomWordPracticeHost: hostKey changed to ${hostKey}, selecting new initial exercise.`);\n    selectAndLoadRandomExercise();\n  }, [hostKey, selectAndLoadRandomExercise]); // selectAndLoadRandomExercise is stable\n\n  const handleSubExerciseComplete = useCallback(() => {\n    console.log(`RandomWordPracticeHost: Sub-exercise ${currentExerciseInfo?.name} completed. Selecting next one.`);\n    // After a sub-exercise completes, load another random one.\n    // Adding a small delay for smoother transition if needed, e.g. after success message.\n    setTimeout(() => {\n      selectAndLoadRandomExercise();\n    }, 500); // 0.5s delay\n  }, [selectAndLoadRandomExercise, currentExerciseInfo]);\n\n  if (isLoading || !CurrentExercise) {\n    return <p>{t('loading.randomWordExercise', 'Loading Random Word Exercise...')}</p>;\n  }\n\n  return (\n    <div className=\"random-word-practice-host-container cosy-exercise-container\">\n      {/* Optional: Display the type of current random word exercise for debugging or clarity */}\n      {/* <p style={{ textAlign: 'center', fontStyle: 'italic', fontSize: '0.9em' }}>\n        Current mode: {currentExerciseInfo?.name || 'N/A'}\n      </p> */}\n      <CurrentExercise\n        language={language}\n        days={days}\n        exerciseKey={subExerciseKey} // Use subExerciseKey to re-mount/reset the specific exercise\n        onComplete={handleSubExerciseComplete} // Pass the completion handler\n        // Note: Ensure all managed exercises accept and call onComplete when they are finished.\n        // MatchOppositesExercise already does. Others might need this prop added.\n      />\n    </div>\n  );\n};\n\nexport default RandomWordPracticeHost;\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport { loadVocabularyData } from '../../../../utils/exerciseDataService';\r\nimport { useLatinizationContext } from '../../../../contexts/LatinizationContext';\r\nimport useLatinization from '../../../../hooks/useLatinization';\r\nimport { pronounceText, unlockAudioPlayback } from '../../../../utils/speechUtils';\r\nimport ExerciseControls from '../../ExerciseControls'; \r\nimport FeedbackDisplay from '../../FeedbackDisplay';\r\nimport { useI18n } from '../../../../i18n/I18nContext';\r\nimport TransliterableText from '../../../Common/TransliterableText';\r\n\r\n\r\nconst ShowWordExercise = ({ language, days, exerciseKey, onComplete }) => { // Added onComplete prop\r\n  const [currentWord, setCurrentWord] = useState('');\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const { isLatinized } = useLatinizationContext();\r\n  const { t, language: i18nLanguage } = useI18n();\r\n\r\n  const latinizedWord = useLatinization(currentWord, language);\r\n\r\n  useEffect(() => {\r\n    unlockAudioPlayback(); \r\n  }, []);\r\n\r\n  const fetchAndSetNewWord = useCallback(async () => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n    setCurrentWord(''); \r\n\r\n    try {\r\n      const { data: words, error: fetchError } = await loadVocabularyData(language, days);\r\n      if (fetchError) {\r\n        throw new Error(fetchError.message || fetchError.error || 'Failed to load vocabulary words.');\r\n      }\r\n      if (words && words.length > 0) {\r\n        const randomIndex = Math.floor(Math.random() * words.length);\r\n        setCurrentWord(words[randomIndex]);\r\n      } else {\r\n        setError(t('exercises.noVocabWords', 'No vocabulary words found for the selected criteria.'));\r\n      }\r\n    } catch (err) {\r\n      console.error(\"ShowWordExercise - Error fetching word:\", err);\r\n      setError(err.message || t('errors.unexpectedError', 'An unexpected error occurred.'));\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [language, days, t]); \r\n\r\n  useEffect(() => {\r\n    if (language && days && days.length > 0) { \r\n        fetchAndSetNewWord();\r\n    } else {\r\n        setIsLoading(false);\r\n        setError(t('errors.selectLangDay', \"Please select a language and day(s).\"));\r\n        setCurrentWord('');\r\n    }\r\n  }, [fetchAndSetNewWord, exerciseKey, language, days, t]);\r\n\r\n  const handlePronounce = async () => {\r\n    if (currentWord && language) {\r\n      try {\r\n        await pronounceText(currentWord, language);\r\n      } catch (speechError) {\r\n        console.error(\"Error pronouncing word:\", speechError);\r\n        setError(t('errors.pronunciationError', \"Could not pronounce the word. Please ensure your browser supports speech synthesis and audio is enabled.\"));\r\n      }\r\n    }\r\n  };\r\n  \r\n  const handleNext = () => {\r\n    if (onComplete) {\r\n      onComplete();\r\n    } else {\r\n      // Fallback if onComplete is not provided (e.g. when used standalone, though not intended for hosts)\r\n      fetchAndSetNewWord(); \r\n    }\r\n  };\r\n\r\n  const wordStyle = (isLatinized && currentWord !== latinizedWord) ? { fontFamily: 'Arial, sans-serif', fontStyle: 'italic' } : {};\r\n\r\n  if (isLoading) {\r\n    return <p><TransliterableText text={t('loading.wordExercise', 'Loading word...')} langOverride={i18nLanguage} /></p>;\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n        <>\r\n            <FeedbackDisplay message={error} type=\"error\" language={i18nLanguage} />\r\n            {/* Still provide controls to try fetching a new word or allow host to move on */}\r\n            <ExerciseControls \r\n              onRandomize={handleNext} // Or fetchAndSetNewWord if preferred for standalone randomize\r\n              onNextExercise={handleNext}\r\n              config={{\r\n                showNext: true,\r\n                showCheck: false,\r\n                showHint: false,\r\n                showReveal: false,\r\n                showRandomize: true, \r\n              }}\r\n            />\r\n        </>\r\n    );\r\n  }\r\n\r\n  if (!currentWord && !isLoading) { \r\n    return (\r\n        <>\r\n            <FeedbackDisplay message={t('exercises.noWordToDisplay', \"No word to display. Try different selections or check data.\")} type=\"info\" language={i18nLanguage} />\r\n             <ExerciseControls \r\n              onRandomize={handleNext}\r\n              onNextExercise={handleNext}\r\n              config={{\r\n                showNext: true,\r\n                showCheck: false,\r\n                showHint: false,\r\n                showReveal: false,\r\n                showRandomize: true, \r\n              }}\r\n            />\r\n        </>\r\n    );\r\n  }\r\n  \r\n  return (\r\n    <div style={{ textAlign: 'center', padding: '20px', border: '1px solid #eee', borderRadius: '8px' }}>\r\n      <h3><TransliterableText text={t('titles.randomWord', 'Random Word')} langOverride={i18nLanguage} /></h3>\r\n      {currentWord && ( \r\n        <>\r\n          <div\r\n            style={{ fontSize: '2.5rem', margin: '20px 0', padding: '10px', ...wordStyle }}\r\n            aria-label={`Word to practice: ${currentWord}`}\r\n          >\r\n            {latinizedWord || currentWord}\r\n          </div>\r\n          <div style={{ marginTop: '20px', display: 'flex', flexDirection: 'column', justifyContent: 'center', alignItems: 'center', gap: '15px' }}>\r\n            <button onClick={handlePronounce} className=\"action-button\" disabled={!currentWord}>\r\n              🔊 <TransliterableText text={t('buttons.pronounce', 'Pronounce')} langOverride={i18nLanguage} />\r\n            </button>\r\n            <ExerciseControls \r\n              onRandomize={handleNext} // Changed from fetchAndSetNewWord to handleNext\r\n              onNextExercise={handleNext} // Changed from fetchAndSetNewWord to handleNext\r\n              config={{\r\n                showNext: true,\r\n                showCheck: false,\r\n                showHint: false,\r\n                showReveal: false,\r\n                showRandomize: true, \r\n              }}\r\n            />\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ShowWordExercise;\r\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport { loadOppositesData, loadVocabularyData } from '../../../../utils/exerciseDataService'; \r\nimport { useLatinizationContext } from '../../../../contexts/LatinizationContext';\r\nimport useLatinization from '../../../../hooks/useLatinization';\r\nimport { pronounceText } from '../../../../utils/speechUtils';\r\nimport FeedbackDisplay from '../../FeedbackDisplay';\r\nimport ExerciseControls from '../../ExerciseControls';\r\nimport { shuffleArray } from '../../../../utils/arrayUtils';\r\nimport { useI18n } from '../../../../i18n/I18nContext';\r\nimport TransliterableText from '../../../Common/TransliterableText'; // For title\r\nimport Button from '../../../Common/Button';\nimport './TypeOppositeExercise.css'; // Will create/update this CSS\r\n\r\nconst NUM_TOTAL_OPTIONS = 4; // 1 correct, 3 distractors\r\n\r\nconst TypeOppositeExercise = ({ language, days, exerciseKey, onComplete }) => {\r\n  const [targetDisplayWord, setTargetDisplayWord] = useState(''); // The word for which opposite is asked\r\n  const [correctOptionText, setCorrectOptionText] = useState(''); // The actual correct opposite text\r\n  const [displayOptions, setDisplayOptions] = useState([]); // { id: string, text: string, isCorrect: boolean, status: 'unselected'|'correct'|'incorrect' }\r\n  \r\n  const [feedback, setFeedback] = useState({ message: '', type: '' });\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [isAnswered, setIsAnswered] = useState(false);\r\n\r\n  const { isLatinized } = useLatinizationContext();\r\n  const getLatinizedText = useLatinization;\r\n  const { t, language: i18nLanguage } = useI18n();\r\n\r\n  const fetchAndPrepareExercise = useCallback(async () => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n    setFeedback({ message: '', type: '' });\r\n    setTargetDisplayWord('');\r\n    setCorrectOptionText('');\r\n    setDisplayOptions([]);\r\n    setIsAnswered(false);\r\n\r\n    try {\r\n      const { data: oppositesMap, error: oppositesError } = await loadOppositesData(language, days);\r\n      if (oppositesError || !oppositesMap || Object.keys(oppositesMap).length === 0) {\r\n        setError(t('exercises.noOppositesData', 'No opposites data found for the selected criteria.'));\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      const wordsWithDefinedOpposites = Object.keys(oppositesMap);\r\n      if (wordsWithDefinedOpposites.length === 0) {\r\n        setError(t('exercises.noWordsWithOpposites', 'No words with opposites found.'));\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      const randomWordKey = wordsWithDefinedOpposites[Math.floor(Math.random() * wordsWithDefinedOpposites.length)];\r\n      const currentWord = randomWordKey;\r\n      const actualCorrectOpposite = oppositesMap[currentWord];\r\n\r\n      setTargetDisplayWord(currentWord);\r\n      setCorrectOptionText(actualCorrectOpposite);\r\n\r\n      // Fetch general vocabulary for distractors\r\n      const { data: allVocab, error: vocabError } = await loadVocabularyData(language, days);\r\n      let potentialDistractorsPool = [];\r\n      if (!vocabError && allVocab) {\r\n        potentialDistractorsPool = allVocab.map(item => typeof item === 'string' ? item : item.word).filter(Boolean);\r\n      } else { // Fallback to keys/values from oppositesMap if general vocab fails\r\n        potentialDistractorsPool = [...new Set([...wordsWithDefinedOpposites, ...Object.values(oppositesMap)])];\r\n      }\r\n      \r\n      potentialDistractorsPool = potentialDistractorsPool.filter(\r\n        word => word !== currentWord && word !== actualCorrectOpposite\r\n      );\r\n      shuffleArray(potentialDistractorsPool);\r\n      const distractors = potentialDistractorsPool.slice(0, NUM_TOTAL_OPTIONS - 1);\r\n      \r\n      const options = [{ text: actualCorrectOpposite, id: `opt_correct_${actualCorrectOpposite}`, isCorrect: true, status: 'unselected' }];\r\n      distractors.forEach((dText, i) => {\r\n        options.push({ text: dText, id: `opt_distractor_${dText}_${i}`, isCorrect: false, status: 'unselected' });\r\n      });\r\n\r\n      // Ensure we have NUM_TOTAL_OPTIONS, if not, it's an issue with data pool size.\r\n      if (options.length < 2 && NUM_TOTAL_OPTIONS > 1) { // Need at least one distractor for MCQ\r\n         setError(t('exercises.notEnoughOptionsForMCQ', 'Not enough distinct words to create multiple choice options.'));\r\n         setIsLoading(false);\r\n         return;\r\n      }\r\n      \r\n      setDisplayOptions(shuffleArray(options));\r\n\r\n    } catch (err) {\r\n      console.error(\"TypeOppositeExercise (MCQ) - Error setting up:\", err);\r\n      setError(err.message || t('errors.unexpectedError', 'An unexpected error occurred.'));\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [language, days, t]);\r\n\r\n  useEffect(() => {\r\n    if (language && days && days.length > 0) {\r\n      fetchAndPrepareExercise();\r\n    } else {\r\n      setIsLoading(false);\r\n      setError(t('errors.selectLangDay', \"Please select a language and day(s).\"));\r\n    }\r\n  }, [fetchAndPrepareExercise, exerciseKey, language, days, t]);\r\n\r\n  const handleOptionClick = (selectedOption) => {\r\n    if (isAnswered || isLoading) return;\r\n    setIsAnswered(true);\r\n\r\n    if (selectedOption.isCorrect) {\r\n      setFeedback({ message: t('feedback.correct', 'Correct!'), type: 'correct' });\r\n      setDisplayOptions(prevOpts => prevOpts.map(opt => \r\n        opt.id === selectedOption.id ? { ...opt, status: 'correct' } : opt\r\n      ));\r\n    } else {\r\n      setFeedback({ \r\n        message: t('feedback.incorrectAnswerWas', `Incorrect. The correct opposite of \"${getLatinizedText(targetDisplayWord, language)}\" is \"${getLatinizedText(correctOptionText, language)}\".`, { \r\n          targetWord: getLatinizedText(targetDisplayWord, language), \r\n          correctAnswer: getLatinizedText(correctOptionText, language) \r\n        }), \r\n        type: 'incorrect' \r\n      });\r\n      setDisplayOptions(prevOpts => prevOpts.map(opt => {\r\n        if (opt.id === selectedOption.id) return { ...opt, status: 'incorrect' };\r\n        if (opt.isCorrect) return { ...opt, status: 'correct' }; // Highlight the correct one\r\n        return opt;\r\n      }));\r\n    }\r\n    if (onComplete) {\r\n      setTimeout(() => onComplete(), selectedOption.isCorrect ? 1500 : 2000); \r\n    }\r\n  };\r\n  \r\n  const handleNextRequestByControl = () => { \r\n    if (onComplete) {\r\n      onComplete();\r\n    } else {\r\n      fetchAndPrepareExercise(); // Fallback\r\n    }\r\n  };\r\n\r\n  const handlePronounceTargetWord = () => {\r\n    if (targetDisplayWord && language) {\r\n      pronounceText(targetDisplayWord, language).catch(err => {\r\n          console.error(\"Pronunciation error:\", err);\r\n          setFeedback({message: t('errors.pronunciationError', 'Could not pronounce the word.'), type: 'error'});\r\n      });\r\n    }\r\n  };\r\n\r\n  if (isLoading) return <p>{t('loading.oppositesExercise', 'Loading opposites exercise...')}</p>;\r\n  if (error) return (\r\n    <>\r\n      <FeedbackDisplay message={error} type=\"error\" />\r\n      <ExerciseControls onNextExercise={handleNextRequestByControl} onRandomize={handleNextRequestByControl} config={{showNext: true, showRandomize: true}} />\r\n    </>\r\n  );\r\n  if (displayOptions.length === 0 && !isLoading) return (\r\n    <>\r\n      <FeedbackDisplay message={t('exercises.noOppositesPair', 'No opposites pair available for MCQ. Try different selections.')} type=\"info\"/>\r\n      <ExerciseControls onNextExercise={handleNextRequestByControl} onRandomize={handleNextRequestByControl} config={{showNext: true, showRandomize: true}} />\r\n    </>\r\n  );\r\n\r\n  return (\r\n    <div className=\"type-opposite-exercise mcq-variant\">\r\n      <h3>\r\n        <TransliterableText \r\n          text={t('titles.whatIsTheOppositeOf', 'What is the opposite of:')} \r\n          langOverride={i18nLanguage} \r\n        />\r\n        <strong style={{ marginLeft: '8px', ...(isLatinized && targetDisplayWord !== getLatinizedText(targetDisplayWord, language) && {fontStyle: 'italic'}) }}>\r\n          {getLatinizedText(targetDisplayWord, language)}\r\n        </strong>\r\n        <Button onClick={handlePronounceTargetWord} disabled={!targetDisplayWord} title={t('tooltips.pronounceWord', `Pronounce word`)} className=\"button--icon\">🔊</Button>\n      </h3>\r\n      \r\n      <div className=\"mcq-options-container\">\r\n        {displayOptions.map((option) => (\r\n          <Button\n            key={option.id}\r\n            onClick={() => handleOptionClick(option)}\r\n            className={`button--mcq ${option.status}`}\n            disabled={isAnswered || isLoading}\r\n          >\r\n            {getLatinizedText(option.text, language)}\r\n          </Button>\n        ))}\r\n      </div>\r\n      \r\n      <FeedbackDisplay message={feedback.message} type={feedback.type} />\r\n      \r\n      <ExerciseControls\r\n        onNextExercise={handleNextRequestByControl} \r\n        onRandomize={handleNextRequestByControl}\r\n        isAnswerCorrect={isAnswered && displayOptions.find(o => o.status === 'correct')?.isCorrect}\r\n        // Reveal and Hint are not implemented for this MCQ version yet\r\n        config={{ \r\n            showCheck: false, \r\n            showHint: false, \r\n            showReveal: false,\r\n            showNext: true, \r\n            showRandomize: true,\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TypeOppositeExercise;\r\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport { loadVocabularyData } from '../../../../utils/exerciseDataService';\r\nimport FeedbackDisplay from '../../FeedbackDisplay';\r\nimport ExerciseControls from '../../ExerciseControls';\r\nimport { useLatinizationContext } from '../../../../contexts/LatinizationContext';\r\nimport useLatinization from '../../../../hooks/useLatinization';\r\nimport { pronounceText } from '../../../../utils/speechUtils';\r\nimport { shuffleArray } from '../../../../utils/arrayUtils';\r\nimport { normalizeString } from '../../../../utils/stringUtils';\r\nimport { useI18n } from '../../../../i18n/I18nContext';\r\nimport './BuildWordExercise.css'; // Import the CSS file\r\n\r\nconst BuildWordExercise = ({ language, days, exerciseKey, onComplete }) => {\r\n  const [correctWord, setCorrectWord] = useState('');\r\n  const [shuffledLetters, setShuffledLetters] = useState([]); \r\n  const [wordSlots, setWordSlots] = useState([]); \r\n  \r\n  const [feedback, setFeedback] = useState({ message: '', type: '' });\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [isRevealed, setIsRevealed] = useState(false);\r\n  const [isCorrectState, setIsCorrectState] = useState(false);\r\n\r\n  const { isLatinized } = useLatinizationContext();\r\n  const getLatinizedText = useLatinization;\r\n  const { t } = useI18n();\r\n\r\n  const latinizedCorrectWord = getLatinizedText(correctWord, language);\r\n\r\n  const setupNewWord = useCallback(async () => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n    setFeedback({ message: '', type: '' });\r\n    setIsRevealed(false);\r\n    setIsCorrectState(false);\r\n    setCorrectWord('');\r\n    setShuffledLetters([]);\r\n    setWordSlots([]);\r\n\r\n    try {\r\n      const { data: words, error: fetchError } = await loadVocabularyData(language, days);\r\n      if (fetchError) {\r\n        throw new Error(fetchError.message || fetchError.error || 'Failed to load vocabulary words.');\r\n      }\r\n      if (words && words.length > 0) {\r\n        let wordForExercise;\r\n        const singleWords = words.filter(w => !w.includes(' ') && w.length > 2 && w.length < 15);\r\n        if (singleWords.length > 0) {\r\n            wordForExercise = singleWords[Math.floor(Math.random() * singleWords.length)];\r\n        } else {\r\n            wordForExercise = words[Math.floor(Math.random() * words.length)].split(' ')[0]; \r\n            if(wordForExercise.length <= 2 || wordForExercise.length >=15) { \r\n                 setError(t('exercises.noSuitableWordBuild', 'Could not find a suitable word (3-14 letters, no spaces) for \"Build Word\" exercise.'));\r\n                 setIsLoading(false);\r\n                 return;\r\n            }\r\n        }\r\n        \r\n        setCorrectWord(wordForExercise);\r\n        setWordSlots(Array(wordForExercise.length).fill({ char: null, originalTileId: null }));\r\n        setShuffledLetters(\r\n          shuffleArray(\r\n            wordForExercise.split('').map((char, index) => ({ char, id: index, inSlot: false, slotIndex: null }))\r\n          )\r\n        );\r\n      } else {\r\n        setError(t('exercises.noWordsFound', 'No vocabulary words found for the selected criteria.'));\r\n      }\r\n    } catch (err) {\r\n      console.error(\"BuildWordExercise - Error fetching word:\", err);\r\n      setError(err.message || t('errors.unexpectedError', 'An unexpected error occurred.'));\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [language, days, t]);\r\n\r\n  useEffect(() => {\r\n    if (language && days && days.length > 0) {\r\n      setupNewWord();\r\n    } else {\r\n      setIsLoading(false);\r\n      setError(t('errors.selectLangDay', \"Please select a language and day(s).\"));\r\n    }\r\n  }, [setupNewWord, exerciseKey, language, days, t]);\r\n\r\n  const handleTileClick = (tile) => {\r\n    if (isRevealed || isCorrectState || tile.inSlot) return;\r\n\r\n    const newWordSlots = [...wordSlots];\r\n    const firstEmptySlotIndex = newWordSlots.findIndex(slot => slot.char === null);\r\n\r\n    if (firstEmptySlotIndex !== -1) {\r\n      newWordSlots[firstEmptySlotIndex] = { char: tile.char, originalTileId: tile.id };\r\n      setWordSlots(newWordSlots);\r\n\r\n      const newShuffledLetters = shuffledLetters.map(t =>\r\n        t.id === tile.id ? { ...t, inSlot: true, slotIndex: firstEmptySlotIndex } : t\r\n      );\r\n      setShuffledLetters(newShuffledLetters);\r\n      setFeedback({ message: '', type: '' });\r\n    }\r\n  };\r\n\r\n  const handleSlotClick = (slotIndex) => {\r\n    if (isRevealed || isCorrectState || !wordSlots[slotIndex] || wordSlots[slotIndex].char === null) return;\r\n\r\n    const tileToReturnId = wordSlots[slotIndex].originalTileId;\r\n    \r\n    const newWordSlots = [...wordSlots];\r\n    newWordSlots[slotIndex] = { char: null, originalTileId: null };\r\n    setWordSlots(newWordSlots);\r\n\r\n    const newShuffledLetters = shuffledLetters.map(t =>\r\n      t.id === tileToReturnId ? { ...t, inSlot: false, slotIndex: null } : t\r\n    );\r\n    setShuffledLetters(newShuffledLetters);\r\n    setFeedback({ message: '', type: '' });\r\n  };\r\n  \r\n  const checkAnswer = () => {\r\n    if (isRevealed || isCorrectState || !correctWord) return;\r\n    const constructedWord = wordSlots.map(slot => slot.char).join('');\r\n    const isCorrectNow = normalizeString(constructedWord) === normalizeString(correctWord);\r\n\r\n    if (isCorrectNow) {\r\n      setFeedback({ message: t('feedback.correct', 'Correct!'), type: 'correct' });\r\n      setIsCorrectState(true);\r\n      if (onComplete) {\r\n        setTimeout(() => onComplete(), 1500);\r\n      }\r\n    } else {\r\n      setFeedback({ message: t('feedback.incorrectKeepTrying', `Incorrect. Keep trying or use a hint.`), type: 'incorrect' });\r\n    }\r\n  };\r\n\r\n  const showHint = () => {\r\n    if (isRevealed || isCorrectState || !correctWord) return;\r\n    let hintSlotIndex = -1;\r\n    const currentConstructedWord = wordSlots.map(slot => slot.char).join('');\r\n\r\n    for (let i = 0; i < correctWord.length; i++) {\r\n      if (!wordSlots[i] || !wordSlots[i].char || normalizeString(wordSlots[i].char) !== normalizeString(correctWord[i])) {\r\n        hintSlotIndex = i;\r\n        break;\r\n      }\r\n    }\r\n    if (hintSlotIndex === -1 && currentConstructedWord.length < correctWord.length) {\r\n        hintSlotIndex = currentConstructedWord.length;\r\n    }\r\n\r\n    if (hintSlotIndex !== -1) {\r\n      const correctCharForHint = correctWord[hintSlotIndex];\r\n      if (wordSlots[hintSlotIndex] && wordSlots[hintSlotIndex].char && normalizeString(wordSlots[hintSlotIndex].char) !== normalizeString(correctCharForHint)) {\r\n        handleSlotClick(hintSlotIndex); \r\n      }\r\n      \r\n      const tileToPlace = shuffledLetters.find(t => !t.inSlot && normalizeString(t.char) === normalizeString(correctCharForHint));\r\n      if (tileToPlace) {\r\n        const newSlots = [...wordSlots]; \r\n        newSlots[hintSlotIndex] = { char: tileToPlace.char, originalTileId: tileToPlace.id };\r\n        setWordSlots(newSlots);\r\n        setShuffledLetters(prevLetters => prevLetters.map(t => t.id === tileToPlace.id ? {...t, inSlot:true, slotIndex: hintSlotIndex} : t));\r\n        setFeedback({ message: t('feedback.hintLetterPlaced', `Hint: Letter \"${getLatinizedText(correctCharForHint, language)}\" placed.`, { letter: getLatinizedText(correctCharForHint, language) }), type: 'hint' });\r\n      } else {\r\n         setFeedback({ message: t('feedback.hintLetterMisplaced', 'Hint: Could not find the next correct letter in the pool (it might be misplaced).'), type: 'info' });\r\n      }\r\n    } else {\r\n      setFeedback({ message: t('feedback.hintWordCorrectOrNoMore', 'Word seems correct or no more hints applicable.'), type: 'info' });\r\n    }\r\n  };\r\n  \r\n  const revealTheAnswer = () => { \r\n    if (!correctWord) return;\r\n    setWordSlots(correctWord.split('').map((char, index) => ({ char, originalTileId: -1-index }))); \r\n    setShuffledLetters(shuffledLetters.map(tile => ({...tile, inSlot: true, slotIndex: correctWord.indexOf(tile.char) }))); \r\n    setFeedback({ message: t('feedback.answerIs', `The word is: ${latinizedCorrectWord || correctWord}`, { answer: latinizedCorrectWord || correctWord }), type: 'info' });\r\n    setIsRevealed(true);\r\n    setIsCorrectState(true); \r\n    if (onComplete) {\r\n        setTimeout(() => onComplete(), 2000);\r\n    }\r\n  };\r\n\r\n  const handleReset = () => {\r\n     if (!correctWord || isRevealed || isCorrectState) return;\r\n     setWordSlots(Array(correctWord.length).fill({ char: null, originalTileId: null }));\r\n     setShuffledLetters(\r\n          shuffleArray( \r\n            correctWord.split('').map((char, index) => ({ char, id: index, inSlot: false, slotIndex: null }))\r\n          )\r\n     );\r\n     setFeedback({ message: '', type: '' });\r\n  };\r\n\r\n  const handleNextRequestByControl = () => {\r\n    if (onComplete) {\r\n      onComplete();\r\n    } else {\r\n      setupNewWord();\r\n    }\r\n  };\r\n\r\n  if (isLoading) return <p>{t('loading.buildWordExercise', 'Loading word building exercise...')}</p>;\r\n  if (error) return (\r\n    <div className=\"build-word-exercise-container\">\r\n      <FeedbackDisplay message={error} type=\"error\" />\r\n      <ExerciseControls onNextExercise={handleNextRequestByControl} config={{showNext: true}} />\r\n    </div>\r\n  );\r\n  if (!correctWord && !isLoading) return (\r\n    <div className=\"build-word-exercise-container\">\r\n      <FeedbackDisplay message={t('exercises.noWordForBuild', 'No word available for this exercise.')} type=\"info\" />\r\n      <ExerciseControls onNextExercise={handleNextRequestByControl} config={{showNext: true}} />\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"build-word-exercise-container\">\r\n      <h3>{t('titles.buildTheWord', 'Build the Word')}</h3>\r\n      <button onClick={() => pronounceText(correctWord, language)} disabled={!correctWord} title={t('tooltips.pronounceWord', \"Pronounce the word\")} className=\"pronounce-button-bwe\">🔊</button>\r\n      \r\n      <div className=\"word-slots-area\">\r\n        {wordSlots.map((slot, index) => (\r\n          <div \r\n            key={`slot-${index}`} \r\n            className={`word-slot ${slot.char ? 'filled-slot' : 'empty-slot'}`}\r\n            onClick={() => handleSlotClick(index)}\r\n          >\r\n            {slot.char ? <span className={`slot-char ${isLatinized && slot.char !== getLatinizedText(slot.char, language) ? 'latinized-char' : ''}`}>{getLatinizedText(slot.char, language)}</span> : <span className=\"slot-placeholder\">?</span>}\r\n          </div>\r\n        ))}\r\n      </div>\r\n      \r\n      <div className=\"letter-pool-area\">\r\n        {shuffledLetters.filter(tile => !tile.inSlot).map(tile => (\r\n          <button \r\n            key={`tile-${tile.id}`} \r\n            className=\"letter-tile\"\r\n            onClick={() => handleTileClick(tile)}\r\n            disabled={isRevealed || isCorrectState}\r\n          >\r\n            <span className={isLatinized && tile.char !== getLatinizedText(tile.char, language) ? 'latinized-char' : ''}>{getLatinizedText(tile.char, language)}</span>\r\n          </button>\r\n        ))}\r\n         {shuffledLetters.filter(tile => !tile.inSlot).length === 0 && !isCorrectState && !isRevealed && \r\n            <span className=\"all-letters-placed-message\">{t('feedback.allLettersPlaced', 'All letters placed! Check your word.')}</span>}\r\n      </div>\r\n      \r\n      <FeedbackDisplay message={feedback.message} type={feedback.type} language={language} />\r\n      \r\n      <ExerciseControls\r\n        onCheckAnswer={!isRevealed && !isCorrectState && wordSlots.every(s => s.char) && correctWord ? checkAnswer : undefined}\r\n        onShowHint={!isRevealed && !isCorrectState && correctWord ? showHint : undefined}\r\n        onRevealAnswer={!isRevealed && !isCorrectState && correctWord ? revealTheAnswer : undefined}\r\n        onNextExercise={handleNextRequestByControl}\r\n        config={{ \r\n            showCheck: !isRevealed && !isCorrectState && wordSlots.every(s => s.char) && !!correctWord, \r\n            showHint: !isRevealed && !isCorrectState && !!correctWord, \r\n            showReveal: !isRevealed && !isCorrectState && !!correctWord,\r\n            showNext: true, \r\n        }}\r\n      />\r\n       <button onClick={handleReset} className=\"reset-tiles-button\" disabled={isRevealed || isCorrectState || !correctWord}>\r\n        🔄 {t('buttons.resetTiles', 'Reset Tiles')}\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BuildWordExercise;\r\n"],"names":["_ref","onCheckAnswer","onRevealAnswer","onShowHint","onRandomize","onNextExercise","config","isAnswerCorrect","isRevealed","customButton","t","useI18n","showCheck","checkButtonText","showReveal","revealButtonText","showHint","hintButtonText","showRandomize","randomizeButtonText","showNext","nextButtonText","canInteract","_jsxs","className","children","_jsx","Button","onClick","disabled","message","type","language","latinizedVersion","useLatinization","processedMessage","isLatinized","useLatinizationContext","style","minHeight","margin","padding","borderRadius","textAlign","fontWeight","animation","textPrefix","backgroundColor","color","borderColor","fontStyle","role","shuffleArray","array","newArray","i","length","j","Math","floor","random","normalizeString","str","undefined","normalized","String","normalize","replace","toLowerCase","managedExerciseComponents","key","Component","days","exerciseKey","onComplete","currentWord","setCurrentWord","useState","isLoading","setIsLoading","error","setError","i18nLanguage","latinizedWord","useEffect","unlockAudioPlayback","fetchAndSetNewWord","useCallback","async","data","words","fetchError","loadVocabularyData","Error","randomIndex","err","console","handleNext","wordStyle","fontFamily","TransliterableText","text","langOverride","_Fragment","FeedbackDisplay","ExerciseControls","border","fontSize","marginTop","display","flexDirection","justifyContent","alignItems","gap","pronounceText","speechError","name","_displayOptions$find","targetDisplayWord","setTargetDisplayWord","correctOptionText","setCorrectOptionText","displayOptions","setDisplayOptions","feedback","setFeedback","isAnswered","setIsAnswered","getLatinizedText","fetchAndPrepareExercise","oppositesMap","oppositesError","loadOppositesData","Object","keys","wordsWithDefinedOpposites","actualCorrectOpposite","allVocab","vocabError","potentialDistractorsPool","map","item","word","filter","Boolean","Set","values","distractors","slice","NUM_TOTAL_OPTIONS","options","id","isCorrect","status","forEach","dText","push","handleNextRequestByControl","marginLeft","handlePronounceTargetWord","catch","title","option","handleOptionClick","selectedOption","prevOpts","opt","targetWord","correctAnswer","setTimeout","find","o","pairs","setPairs","wordsColumn","setWordsColumn","oppositesColumn","setOppositesColumn","selectedWord","setSelectedWord","selectedOpposite","setSelectedOpposite","matchedItems","setMatchedItems","numCorrectMatches","setNumCorrectMatches","setIsRevealed","lines","setLines","itemRefs","useRef","columnsContainerRef","setupExercise","current","NUM_PAIRS_TO_DISPLAY","allPossiblePairs","entries","_ref2","opposite","selectedPairs","p","handleItemClick","itemValue","event","currentSelection","value","element","target","drawLine","el1","el2","containerRect","getBoundingClientRect","rect1","rect2","x1","left","width","scrollLeft","y1","top","height","scrollTop","x2","y2","lineKey","textContent","prevLines","currentWordValue","currentOppositeValue","some","pair","prev","classList","add","remove","columnStyle","flex","itemStyle","base","cursor","minWidth","transition","boxShadow","transform","maxWidth","ref","position","pointerEvents","zIndex","line","stroke","strokeWidth","opacity","el","e","unMatchedPairs","hintPair","revealAllAnswers","allCurrentlyMatched","linesForRevealed","correctWord","setCorrectWord","shuffledLetters","setShuffledLetters","wordSlots","setWordSlots","isCorrectState","setIsCorrectState","latinizedCorrectWord","setupNewWord","wordForExercise","singleWords","w","includes","split","Array","fill","char","originalTileId","index","inSlot","slotIndex","handleSlotClick","tileToReturnId","newWordSlots","newShuffledLetters","slot","tile","firstEmptySlotIndex","findIndex","handleTileClick","every","s","checkAnswer","join","hintSlotIndex","currentConstructedWord","correctCharForHint","tileToPlace","newSlots","prevLetters","letter","revealTheAnswer","indexOf","answer","handleReset","hostKey","CurrentExercise","setCurrentExercise","currentExerciseInfo","setCurrentExerciseInfo","subExerciseKey","setSubExerciseKey","selectAndLoadRandomExercise","selected","log","handleSubExerciseComplete"],"sourceRoot":""}