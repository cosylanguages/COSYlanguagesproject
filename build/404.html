<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Redirecting...</title>
    <script type="text/javascript">
      // Single Page Apps for GitHub Pages
      // MIT License
      // https://github.com/rafgraph/spa-github-pages
      // This script takes the current url and converts the path and query
      // string into just a query string, and then redirects the browser
      // to the new url with only a query string and hash fragment,
      // e.g. http://user.github.io/repo/?p=/some/path&q=X#hash
      // Note: this 404.html file must be at least 512 bytes for Internet Explorer to display it.

      var l = window.location;
      // segmentCount is the number of segments of the path that represent the base URL
      // For example, if your site is at https://user.github.io/repo/, segmentCount should be 1.
      // If at https://user.github.io/, segmentCount should be 0.
      var segmentCount = l.pathname.startsWith('/COSYlanguagesproject/') ? 1 : 0;
      // A more generic way if you don't want to hardcode 'COSYlanguagesproject':
      // var segmentCount = l.hostname.endsWith('github.io') && l.pathname.split('/')[1] && l.pathname.split('/')[1] !== '' ? 1 : 0;
      // However, given that basename is hardcoded in src/index.js for prod, being specific here is okay.


      var newPath = l.pathname.slice(1).split('/').slice(segmentCount).join('/');
      var newSearch = l.search ? '&q=' + l.search.slice(1).replace(/&/g, '~and~') : '';
      var newHash = l.hash;

      // Construct the new URL to redirect to.
      // It should go to the root of the SPA, which is index.html in the base directory.
      // Base directory path:
      var baseDir = l.pathname.split('/').slice(0, 1 + segmentCount).join('/') + '/';
      if (baseDir === "//") baseDir = "/"; // Handles case where segmentCount is 0 and path was /something -> //?p=...

      var redirectTo = l.protocol + '//' + l.hostname + (l.port ? ':' + l.port : '') +
                       baseDir + 
                       '?p=/' + newPath + // Ensure 'p' starts with a slash
                       newSearch +
                       newHash;
      
      l.replace(redirectTo);

    </script>
  </head>
  <body>
    <!-- IE requires 512+ bytes: https://blogs.msdn.microsoft.com/ieinternals/2010/08/18/friendly-http-error-pages/ -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
  </body>
</html>
