<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Redirecting...</title>
    <script type="text/javascript">
      // Single Page Apps for GitHub Pages
      // MIT License
      // https://github.com/rafgraph/spa-github-pages
      // This script takes the current url and converts the path and query
      // string into just a query string, and then redirects the browser
      // to the new url with only a query string and hash fragment,
      // e.g. http://user.github.io/repo/?p=/some/path&q=X#hash
      // Note: this 404.html file must be at least 512 bytes for Internet Explorer to display it.

      (function() {
        var l = window.location;
        // Correctly determine the basename from the script tag.
        // This makes the script more portable and less dependent on hardcoded values.
        var SCRIPT_NAME = 'spa-github-pages-script';
        var script = document.getElementById(SCRIPT_NAME);
        // The script src will be like "https://user.github.io/repo/404.html" or "/repo/404.html"
        // We want to extract the "/repo" part.
        var path = script.src.substring(l.origin.length, script.src.lastIndexOf('/'));

        var segmentCount = path.startsWith('/') ? path.split('/').length -1 : 0;

        var newPath = l.pathname.slice(1).split('/').slice(segmentCount).join('/');
        var newSearch = l.search ? '&q=' + l.search.slice(1).replace(/&/g, '~and~') : '';
        var newHash = l.hash;

        var baseDir = path + '/';

        var redirectTo = l.protocol + '//' + l.hostname + (l.port ? ':' + l.port : '') +
                         baseDir +
                         '?p=/' + newPath +
                         newSearch +
                         newHash;

        l.replace(redirectTo);
      })();

    </script>
  </head>
  <body>
    <!-- IE requires 512+ bytes: https://blogs.msdn.microsoft.com/ieinternals/2010/08/18/friendly-http-error-pages/ -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
    <!--                                                                          -->
  </body>
</html>
